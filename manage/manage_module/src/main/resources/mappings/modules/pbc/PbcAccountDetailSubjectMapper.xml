<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.heepay.manage.modules.pbc.dao.PbcAccountDetailSubjectDao" >
  
  <sql id="includeEntity">
	  a.account_detail_id, 
	  a.data_type, 
	  a.data, 
      a.subject_type, 
      a.account_owner_name, 
      a.account_owner_id_type, 
      a.account_owner_id, 
      a.credential_validity, 
      a.tel_number, 
      a.binding_data_type, 
      a.binding_data, 
      a.online_shop_name, 
      a.merchant_number, 
      a.bank_id, 
      a.bank_name, 
      a.bank_account, 
      a.card_type, 
      a.card_validation, 
      a.card_expiry_date, 
      a.card_info, 
      a.application_code
	</sql>
	
	<select id="findList" resultType="PbcAccountDetailSubject">
		SELECT 
			<include refid="includeEntity"/>
		FROM pbc_account_detail_subject a
		<where>
		
			<!--dataType -->
			<if test="dataType != null and dataType != ''">
				AND a.data_type = #{dataType} 
			</if> 
			<!-- accountOwnerIdType-->
			<if test="accountOwnerIdType != null and accountOwnerIdType != ''">
				AND a.account_owner_id_type = #{accountOwnerIdType} 
			</if> 
			<!-- accountOwnerId-->
			<if test="accountOwnerId != null and accountOwnerId != ''">
				AND a.account_owner_id = #{accountOwnerId} 
			</if> 
			<!-- tel_number-->
			<if test="telNumber != null and telNumber != ''">
				AND a.tel_number = #{telNumber} 
			</if> 
			
			
			<!-- merchantNumber -->
			<if test="merchantNumber != null and merchantNumber != ''">
				AND a.merchant_number = #{merchantNumber} 
			</if> 
			<!-- bankId -->
			<if test="bankId != null and bankId != ''">
				AND a.bank_id = #{bankId} 
			</if> 
			<!-- bankAccount  -->
			<if test="bankAccount  != null and bankAccount != ''"> 
				AND a.bank_account = #{bankAccount} 
			</if> 
			<!-- applicationCode  -->
			<if test="applicationCode  != null and applicationCode != ''"> 
				AND a.application_code = #{applicationCode} 
			</if> 
			</where> 
		<choose>
			<when test="page !=null and page.orderBy != null and page.orderBy != ''">
				ORDER BY account_detail_id DESC,${page.orderBy}
			</when>
			<otherwise>
				ORDER BY account_detail_id DESC
			</otherwise>
		</choose>
	</select>
	
  
  <insert id="save" parameterType="PbcAccountDetailSubject" >
   insert into pbc_account_detail_subject (account_detail_id, data_type, data, 
      subject_type, account_owner_name, account_owner_id_type, 
      account_owner_id, credential_validity, tel_number, 
      binding_data_type, binding_data, online_shop_name, 
      merchant_number, bank_id, bank_name, 
      bank_account, card_type, card_validation, 
      card_expiry_date, card_info, application_code
      )
    values (#{accountDetailId,jdbcType=BIGINT}, #{dataType,jdbcType=VARCHAR}, #{data,jdbcType=VARCHAR}, 
      #{subjectType,jdbcType=VARCHAR}, #{accountOwnerName,jdbcType=VARCHAR}, #{accountOwnerIdType,jdbcType=VARCHAR}, 
      #{accountOwnerId,jdbcType=VARCHAR}, #{credentialValidity,jdbcType=VARCHAR}, #{telNumber,jdbcType=VARCHAR}, 
      #{bindingDataType,jdbcType=VARCHAR}, #{bindingData,jdbcType=VARCHAR}, #{onlineShopName,jdbcType=VARCHAR}, 
      #{merchantNumber,jdbcType=VARCHAR}, #{bankId,jdbcType=VARCHAR}, #{bankName,jdbcType=VARCHAR}, 
      #{bankAccount,jdbcType=VARCHAR}, #{cardType,jdbcType=VARCHAR}, #{cardValidation,jdbcType=VARCHAR}, 
      #{cardExpiryDate,jdbcType=VARCHAR}, #{cardInfo,jdbcType=VARCHAR}, #{applicationCode,jdbcType=VARCHAR}
      )
  </insert>
  
  <insert id="saveEntity" parameterType="PbcAccountDetailSubject" useGeneratedKeys="true" keyProperty="accountDetailId">
    insert into pbc_account_detail_subject
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="accountDetailId != null" >
        account_detail_id,
      </if>
      <if test="dataType != null" >
        data_type,
      </if>
      <if test="data != null" >
        data,
      </if>
      <if test="subjectType != null" >
        subject_type,
      </if>
      <if test="accountOwnerName != null" >
        account_owner_name,
      </if>
      <if test="accountOwnerIdType != null" >
        account_owner_id_type,
      </if>
      <if test="accountOwnerId != null" >
        account_owner_id,
      </if>
      <if test="credentialValidity != null" >
        credential_validity,
      </if>
      <if test="telNumber != null" >
        tel_number,
      </if>
      <if test="bindingDataType != null" >
        binding_data_type,
      </if>
      <if test="bindingData != null" >
        binding_data,
      </if>
      <if test="onlineShopName != null" >
        online_shop_name,
      </if>
      <if test="merchantNumber != null" >
        merchant_number,
      </if>
      <if test="bankId != null" >
        bank_id,
      </if>
      <if test="bankName != null" >
        bank_name,
      </if>
      <if test="bankAccount != null" >
        bank_account,
      </if>
      <if test="cardType != null" >
        card_type,
      </if>
      <if test="cardValidation != null" >
        card_validation,
      </if>
      <if test="cardExpiryDate != null" >
        card_expiry_date,
      </if>
      <if test="cardInfo != null" >
        card_info,
      </if>
      <if test="applicationCode != null" >
        application_code,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="accountDetailId != null" >
        #{accountDetailId,jdbcType=BIGINT},
      </if>
      <if test="dataType != null" >
        #{dataType,jdbcType=VARCHAR},
      </if>
      <if test="data != null" >
        #{data,jdbcType=VARCHAR},
      </if>
      <if test="subjectType != null" >
        #{subjectType,jdbcType=VARCHAR},
      </if>
      <if test="accountOwnerName != null" >
        #{accountOwnerName,jdbcType=VARCHAR},
      </if>
      <if test="accountOwnerIdType != null" >
        #{accountOwnerIdType,jdbcType=VARCHAR},
      </if>
      <if test="accountOwnerId != null" >
        #{accountOwnerId,jdbcType=VARCHAR},
      </if>
      <if test="credentialValidity != null" >
        #{credentialValidity,jdbcType=VARCHAR},
      </if>
      <if test="telNumber != null" >
        #{telNumber,jdbcType=VARCHAR},
      </if>
      <if test="bindingDataType != null" >
        #{bindingDataType,jdbcType=VARCHAR},
      </if>
      <if test="bindingData != null" >
        #{bindingData,jdbcType=VARCHAR},
      </if>
      <if test="onlineShopName != null" >
        #{onlineShopName,jdbcType=VARCHAR},
      </if>
      <if test="merchantNumber != null" >
        #{merchantNumber,jdbcType=VARCHAR},
      </if>
      <if test="bankId != null" >
        #{bankId,jdbcType=VARCHAR},
      </if>
      <if test="bankName != null" >
        #{bankName,jdbcType=VARCHAR},
      </if>
      <if test="bankAccount != null" >
        #{bankAccount,jdbcType=VARCHAR},
      </if>
      <if test="cardType != null" >
        #{cardType,jdbcType=VARCHAR},
      </if>
      <if test="cardValidation != null" >
        #{cardValidation,jdbcType=VARCHAR},
      </if>
      <if test="cardExpiryDate != null" >
        #{cardExpiryDate,jdbcType=VARCHAR},
      </if>
      <if test="cardInfo != null" >
        #{cardInfo,jdbcType=VARCHAR},
      </if>
      <if test="applicationCode != null" >
        #{applicationCode,jdbcType=VARCHAR},
      </if>
    </trim>
  </insert>
  
  <update id="updateEntity" parameterType="PbcAccountDetailSubject" >
    update pbc_account_detail_subject
    <set >
      <if test="dataType != null" >
        data_type = #{dataType,jdbcType=VARCHAR},
      </if>
      <if test="data != null" >
        data = #{data,jdbcType=VARCHAR},
      </if>
      <if test="subjectType != null" >
        subject_type = #{subjectType,jdbcType=VARCHAR},
      </if>
      <if test="accountOwnerName != null" >
        account_owner_name = #{accountOwnerName,jdbcType=VARCHAR},
      </if>
      <if test="accountOwnerIdType != null" >
        account_owner_id_type = #{accountOwnerIdType,jdbcType=VARCHAR},
      </if>
      <if test="accountOwnerId != null" >
        account_owner_id = #{accountOwnerId,jdbcType=VARCHAR},
      </if>
      <if test="credentialValidity != null" >
        credential_validity = #{credentialValidity,jdbcType=VARCHAR},
      </if>
      <if test="telNumber != null" >
        tel_number = #{telNumber,jdbcType=VARCHAR},
      </if>
      <if test="bindingDataType != null" >
        binding_data_type = #{bindingDataType,jdbcType=VARCHAR},
      </if>
      <if test="bindingData != null" >
        binding_data = #{bindingData,jdbcType=VARCHAR},
      </if>
      <if test="onlineShopName != null" >
        online_shop_name = #{onlineShopName,jdbcType=VARCHAR},
      </if>
      <if test="merchantNumber != null" >
        merchant_number = #{merchantNumber,jdbcType=VARCHAR},
      </if>
      <if test="bankId != null" >
        bank_id = #{bankId,jdbcType=VARCHAR},
      </if>
      <if test="bankName != null" >
        bank_name = #{bankName,jdbcType=VARCHAR},
      </if>
      <if test="bankAccount != null" >
        bank_account = #{bankAccount,jdbcType=VARCHAR},
      </if>
      <if test="cardType != null" >
        card_type = #{cardType,jdbcType=VARCHAR},
      </if>
      <if test="cardValidation != null" >
        card_validation = #{cardValidation,jdbcType=VARCHAR},
      </if>
      <if test="cardExpiryDate != null" >
        card_expiry_date = #{cardExpiryDate,jdbcType=VARCHAR},
      </if>
      <if test="cardInfo != null" >
        card_info = #{cardInfo,jdbcType=VARCHAR},
      </if>
      <if test="applicationCode != null" >
        application_code = #{applicationCode,jdbcType=VARCHAR},
      </if>
    </set>
    where account_detail_id = #{accountDetailId,jdbcType=BIGINT}
  </update>
  
  <update id="update" parameterType="PbcAccountDetailSubject" >
     update pbc_account_detail_subject
    set data_type = #{dataType,jdbcType=VARCHAR},
      data = #{data,jdbcType=VARCHAR},
      subject_type = #{subjectType,jdbcType=VARCHAR},
      account_owner_name = #{accountOwnerName,jdbcType=VARCHAR},
      account_owner_id_type = #{accountOwnerIdType,jdbcType=VARCHAR},
      account_owner_id = #{accountOwnerId,jdbcType=VARCHAR},
      credential_validity = #{credentialValidity,jdbcType=VARCHAR},
      tel_number = #{telNumber,jdbcType=VARCHAR},
      binding_data_type = #{bindingDataType,jdbcType=VARCHAR},
      binding_data = #{bindingData,jdbcType=VARCHAR},
      online_shop_name = #{onlineShopName,jdbcType=VARCHAR},
      merchant_number = #{merchantNumber,jdbcType=VARCHAR},
      bank_id = #{bankId,jdbcType=VARCHAR},
      bank_name = #{bankName,jdbcType=VARCHAR},
      bank_account = #{bankAccount,jdbcType=VARCHAR},
      card_type = #{cardType,jdbcType=VARCHAR},
      card_validation = #{cardValidation,jdbcType=VARCHAR},
      card_expiry_date = #{cardExpiryDate,jdbcType=VARCHAR},
      card_info = #{cardInfo,jdbcType=VARCHAR},
      application_code = #{applicationCode,jdbcType=VARCHAR}
    where account_detail_id = #{accountDetailId,jdbcType=BIGINT}
  </update>
  
  <select id="getEntityById" resultType="PbcAccountDetailSubject">
  	SELECT 
			<include refid="includeEntity"/>
		FROM pbc_account_detail_subject a
	WHERE account_detail_id = #{accountDetailId}
  </select>
  
  <select id="getFeeBackId" resultType="PbcAccountDetailSubject">
  	SELECT 
			<include refid="includeEntity"/>
		FROM pbc_account_detail_subject a
	WHERE application_code = #{applicationCode}
  </select>
  
  <insert id="insertValue" parameterType="List">
  		insert into pbc_account_detail_subject (account_detail_id, data_type, data, 
      subject_type, account_owner_name, account_owner_id_type, 
      account_owner_id, credential_validity, tel_number, 
      binding_data_type, binding_data, online_shop_name, 
      merchant_number, bank_id, bank_name, 
      bank_account, card_type, card_validation, 
      card_expiry_date, card_info, application_code
      )
    values 
    	<foreach collection="list" item="item" index="index" separator=",">
     (#{item.accountDetailId}, #{item.dataType}, #{item.data}, 
      #{item.subjectType}, #{item.accountOwnerName}, #{item.accountOwnerIdType}, 
      #{item.accountOwnerId}, #{item.credentialValidity}, #{item.telNumber}, 
      #{item.bindingDataType}, #{item.bindingData}, #{item.onlineShopName}, 
      #{item.merchantNumber}, #{item.bankId}, #{item.bankName}, 
      #{item.bankAccount}, #{item.cardType}, #{item.cardValidation}, 
      #{item.cardExpiryDate}, #{item.cardInfo}, #{item.applicationCode}
      )
    </foreach>
  </insert>
  
  <insert id="saveMap"  parameterType="Map">
	 insert into pbc_account_detail_subject
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="accountDetailId != null" >
        account_detail_id,
      </if>
      <if test="dataType != null" >
        data_type,
      </if>
      <if test="data != null" >
        data,
      </if>
      <if test="subjectType != null" >
        subject_type,
      </if>
      <if test="accountOwnerName != null" >
        account_owner_name,
      </if>
      <if test="accountOwnerIdType != null" >
        account_owner_id_type,
      </if>
      <if test="accountOwnerId != null" >
        account_owner_id,
      </if>
      <if test="credentialValidity != null" >
        credential_validity,
      </if>
      <if test="telNumber != null" >
        tel_number,
      </if>
      <if test="bindingDataType != null" >
        binding_data_type,
      </if>
      <if test="bindingData != null" >
        binding_data,
      </if>
      <if test="onlineShopName != null" >
        online_shop_name,
      </if>
      <if test="merchantNumber != null" >
        merchant_number,
      </if>
      <if test="bankId != null" >
        bank_id,
      </if>
      <if test="bankName != null" >
        bank_name,
      </if>
      <if test="bankAccount != null" >
        bank_account,
      </if>
      <if test="cardType != null" >
        card_type,
      </if>
      <if test="cardValidation != null" >
        card_validation,
      </if>
      <if test="cardExpiryDate != null" >
        card_expiry_date,
      </if>
      <if test="cardInfo != null" >
        card_info,
      </if>
      <if test="applicationCode != null" >
        application_code,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="accountDetailId != null" >
        #{accountDetailId,jdbcType=BIGINT},
      </if>
      <if test="dataType != null" >
        #{dataType,jdbcType=VARCHAR},
      </if>
      <if test="data != null" >
        #{data,jdbcType=VARCHAR},
      </if>
      <if test="subjectType != null" >
        #{subjectType,jdbcType=VARCHAR},
      </if>
      <if test="accountOwnerName != null" >
        #{accountOwnerName,jdbcType=VARCHAR},
      </if>
      <if test="accountOwnerIdType != null" >
        #{accountOwnerIdType,jdbcType=VARCHAR},
      </if>
      <if test="accountOwnerId != null" >
        #{accountOwnerId,jdbcType=VARCHAR},
      </if>
      <if test="credentialValidity != null" >
        #{credentialValidity,jdbcType=VARCHAR},
      </if>
      <if test="telNumber != null" >
        #{telNumber,jdbcType=VARCHAR},
      </if>
      <if test="bindingDataType != null" >
        #{bindingDataType,jdbcType=VARCHAR},
      </if>
      <if test="bindingData != null" >
        #{bindingData,jdbcType=VARCHAR},
      </if>
      <if test="onlineShopName != null" >
        #{onlineShopName,jdbcType=VARCHAR},
      </if>
      <if test="merchantNumber != null" >
        #{merchantNumber,jdbcType=VARCHAR},
      </if>
      <if test="bankId != null" >
        #{bankId,jdbcType=VARCHAR},
      </if>
      <if test="bankName != null" >
        #{bankName,jdbcType=VARCHAR},
      </if>
      <if test="bankAccount != null" >
        #{bankAccount,jdbcType=VARCHAR},
      </if>
      <if test="cardType != null" >
        #{cardType,jdbcType=VARCHAR},
      </if>
      <if test="cardValidation != null" >
        #{cardValidation,jdbcType=VARCHAR},
      </if>
      <if test="cardExpiryDate != null" >
        #{cardExpiryDate,jdbcType=VARCHAR},
      </if>
      <if test="cardInfo != null" >
        #{cardInfo,jdbcType=VARCHAR},
      </if>
      <if test="applicationCode != null" >
        #{applicationCode,jdbcType=VARCHAR},
      </if>
    </trim>
  </insert>
  
  <select id="getListByMerchantNumber" resultType="PbcAccountDetailSubject">
  		SELECT 
			<include refid="includeEntity"/>
		FROM pbc_account_detail_subject a
		WHERE a.merchant_number = #{merchantNumber}
  </select>
  
  <select id="getListByfeatureCode" resultType="PbcAccountDetailSubject">
  		SELECT 
			<include refid="includeEntity"/>
		FROM pbc_account_detail_subject a
		WHERE a.application_code = #{applicationCode}
  </select>
  
  <delete id="deleteData">
  	DELETE FROM pbc_account_detail_subject WHERE merchant_number=#{merchantNumber};
  </delete>
</mapper>
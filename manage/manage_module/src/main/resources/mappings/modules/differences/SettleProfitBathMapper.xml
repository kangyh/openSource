<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.heepay.manage.modules.differences.dao.SettleProfitBathDao" >

	 <sql id="clearingChannelRecordColumns">
		s.settle_profit_id  AS "settleProfitId",
		s.merchant_id AS "merchantId",
		s.trans_type AS "transType",
		s.currency AS "currency",
		s.profit_bath AS "profitBath",
		s.profit_date  AS "profitDate",
		s.deal_time  AS "dealTime",
		s.trans_no  AS "transNo",
		s.profit_amount  AS "profitAmount",
		s.fee AS "fee",
		s.profit_status AS "profitStatus",
		s.settle_bath AS "settleBath"
	</sql>
	<select id="findList" resultType="SettleProfitBath">
		SELECT 
			<include refid="clearingChannelRecordColumns"/>
		FROM settle_profit_bath s
		<where>
			
			<!-- 通道对账日期 -->
			<if test="beginOperEndTime != null and endOperEndTime != null">
				AND s.profit_date BETWEEN date_format(#{beginOperEndTime},'%Y-%m-%d %H:%i:%s') AND date_format(#{endOperEndTime},'%Y-%m-%d %H:%i:%s')
			</if>
			<!-- profit_bath -->
			<if test="profitBath != null and profitBath != ''">
				AND s.profit_bath = #{profitBath}
			</if>
			<!-- trans_no-->
			<if test="transNo != null and transNo != ''">
				AND s.trans_no = #{transNo}
			</if>
			
			<!-- settle_bath-->
			<if test="settleBath != null and settleBath != ''">
				AND s.settle_bath = #{settleBath}
			</if>
			
			<!-- profitStatus-->
			<if test="profitStatus != null and profitStatus != ''">
				AND s.profit_status = #{profitStatus}
			</if>
			
		</where>
		<choose>
			<when test="page !=null and page.orderBy != null and page.orderBy != ''">
				ORDER BY settle_profit_id DESC,${page.orderBy}
			</when>
			<otherwise>
				ORDER BY settle_profit_id DESC
			</otherwise>
		</choose>
	</select>
	
	<select id="findListExcel" resultType="hashmap">
		SELECT 
			<include refid="clearingChannelRecordColumns"/>
		FROM settle_profit_bath s
		<where>
			<!-- 通道对账日期 -->
			<if test="beginOperEndTime != null and endOperEndTime != null">
				AND s.profit_date BETWEEN date_format(#{beginOperEndTime},'%Y-%m-%d %H:%i:%s') AND date_format(#{endOperEndTime},'%Y-%m-%d %H:%i:%s')
			</if>
			<!-- profit_bath -->
			<if test="profitBath != null and profitBath != ''">
				AND s.profit_bath = #{profitBath}
			</if>
			<!-- trans_no-->
			<if test="transNo != null and transNo != ''">
				AND s.trans_no = #{transNo}
			</if>
			
			<!-- settle_bath-->
			<if test="settleBath != null and settleBath != ''">
				AND s.settle_bath = #{settleBath}
			</if>
			
			<!-- profitStatus-->
			<if test="profitStatus != null and profitStatus != ''">
				AND s.profit_status = #{profitStatus}
			</if>
			
		</where>
		<choose>
			<when test="page !=null and page.orderBy != null and page.orderBy != ''">
				ORDER BY settle_profit_id DESC,${page.orderBy}
			</when>
			<otherwise>
				ORDER BY settle_profit_id DESC
			</otherwise>
		</choose>
	</select>
</mapper>